/*!
 * # Semantic UI - Sticky
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,i,n){"use strict";e.fn.sticky=function(i){var a,o=e(this),r=o.selector||"",s=(new Date).getTime(),l=[],c=arguments[0],u="string"==typeof c,d=[].slice.call(arguments,1);return o.each(function(){var o,h,p,m,f=e.isPlainObject(i)?e.extend(!0,{},e.fn.sticky.settings,i):e.extend({},e.fn.sticky.settings),g=f.className,v=f.namespace,b=f.error,y="."+v,T="module-"+v,k=e(this),C=e(t),E=e(f.scrollContext),w=(k.selector||"",k.data(T)),D=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)},I=this;m={initialize:function(){m.determineContainer(),m.determineContext(),m.verbose("Initializing sticky",f,o),m.save.positions(),m.checkErrors(),m.bind.events(),f.observeChanges&&m.observeChanges(),m.instantiate()},instantiate:function(){m.verbose("Storing instance of module",m),w=m,k.data(T,m)},destroy:function(){m.verbose("Destroying previous instance"),m.reset(),p&&p.disconnect(),C.off("load"+y,m.event.load).off("resize"+y,m.event.resize),E.off("scrollchange"+y,m.event.scrollchange),k.removeData(T)},observeChanges:function(){var e=h[0];"MutationObserver"in t&&(p=new MutationObserver(function(e){clearTimeout(m.timer),m.timer=setTimeout(function(){m.verbose("DOM tree modified, updating sticky menu",e),m.refresh()},100)}),p.observe(I,{childList:!0,subtree:!0}),p.observe(e,{childList:!0,subtree:!0}),m.debug("Setting up mutation observer",p))},determineContainer:function(){o=k.offsetParent()},determineContext:function(){return h=f.context?e(f.context):o,0===h.length?void m.error(b.invalidContext,f.context,k):void 0},checkErrors:function(){return m.is.hidden()&&m.error(b.visible,k),m.cache.element.height>m.cache.context.height?(m.reset(),void m.error(b.elementSize,k)):void 0},bind:{events:function(){C.on("load"+y,m.event.load).on("resize"+y,m.event.resize),E.off("scroll"+y).on("scroll"+y,m.event.scroll).on("scrollchange"+y,m.event.scrollchange)}},event:{load:function(){m.verbose("Page contents finished loading"),D(m.refresh)},resize:function(){m.verbose("Window resized"),D(m.refresh)},scroll:function(){D(function(){E.triggerHandler("scrollchange"+y,E.scrollTop())})},scrollchange:function(e,t){m.stick(t),f.onScroll.call(I)}},refresh:function(e){m.reset(),f.context||m.determineContext(),e&&m.determineContainer(),m.save.positions(),m.stick(),f.onReposition.call(I)},supports:{sticky:function(){var t=e("<div/>");t[0];return t.addClass(g.supported),t.css("position").match("sticky")}},save:{lastScroll:function(e){m.lastScroll=e},elementScroll:function(e){m.elementScroll=e},positions:function(){var e={height:C.height()},t={margin:{top:parseInt(k.css("margin-top"),10),bottom:parseInt(k.css("margin-bottom"),10)},offset:k.offset(),width:k.outerWidth(),height:k.outerHeight()},i={offset:h.offset(),height:h.outerHeight()};({height:o.outerHeight()});m.cache={fits:t.height<e.height,window:{height:e.height},element:{margin:t.margin,top:t.offset.top-t.margin.top,left:t.offset.left,width:t.width,height:t.height,bottom:t.offset.top+t.height},context:{top:i.offset.top,height:i.height,bottom:i.offset.top+i.height}},m.set.containerSize(),m.set.size(),m.stick(),m.debug("Caching element positions",m.cache)}},get:{direction:function(e){var t="down";return e=e||E.scrollTop(),m.lastScroll!==n&&(m.lastScroll<e?t="down":m.lastScroll>e&&(t="up")),t},scrollChange:function(e){return e=e||E.scrollTop(),m.lastScroll?e-m.lastScroll:0},currentElementScroll:function(){return m.elementScroll?m.elementScroll:m.is.top()?Math.abs(parseInt(k.css("top"),10))||0:Math.abs(parseInt(k.css("bottom"),10))||0},elementScroll:function(e){e=e||E.scrollTop();var t=m.cache.element,i=m.cache.window,n=m.get.scrollChange(e),a=t.height-i.height+f.offset,o=m.get.currentElementScroll(),r=o+n;return o=m.cache.fits||0>r?0:r>a?a:r}},remove:{lastScroll:function(){delete m.lastScroll},elementScroll:function(e){delete m.elementScroll},offset:function(){k.css("margin-top","")}},set:{offset:function(){m.verbose("Setting offset on element",f.offset),k.css("margin-top",f.offset)},containerSize:function(){var e=o.get(0).tagName;"HTML"===e||"body"==e?m.determineContainer():Math.abs(o.outerHeight()-m.cache.context.height)>f.jitter&&(m.debug("Context has padding, specifying exact height for container",m.cache.context.height),o.css({height:m.cache.context.height}))},minimumSize:function(){var e=m.cache.element;o.css("min-height",e.height)},scroll:function(e){m.debug("Setting scroll on element",e),m.elementScroll!=e&&(m.is.top()&&k.css("bottom","").css("top",-e),m.is.bottom()&&k.css("top","").css("bottom",e))},size:function(){0!==m.cache.element.height&&0!==m.cache.element.width&&(I.style.setProperty("width",m.cache.element.width+"px","important"),I.style.setProperty("height",m.cache.element.height+"px","important"))}},is:{top:function(){return k.hasClass(g.top)},bottom:function(){return k.hasClass(g.bottom)},initialPosition:function(){return!m.is.fixed()&&!m.is.bound()},hidden:function(){return!k.is(":visible")},bound:function(){return k.hasClass(g.bound)},fixed:function(){return k.hasClass(g.fixed)}},stick:function(e){var t=e||E.scrollTop(),i=m.cache,n=i.fits,a=i.element,o=i.window,r=i.context,s=m.is.bottom()&&f.pushing?f.bottomOffset:f.offset,e={top:t+s,bottom:t+s+o.height},l=(m.get.direction(e.top),n?0:m.get.elementScroll(e.top)),c=!n,u=0!==a.height;u&&(m.is.initialPosition()?e.top>=r.bottom?(m.debug("Initial element position is bottom of container"),m.bindBottom()):e.top>a.top&&(a.height+e.top-l>=r.bottom?(m.debug("Initial element position is bottom of container"),m.bindBottom()):(m.debug("Initial element position is fixed"),m.fixTop())):m.is.fixed()?m.is.top()?e.top<=a.top?(m.debug("Fixed element reached top of container"),m.setInitialPosition()):a.height+e.top-l>=r.bottom?(m.debug("Fixed element reached bottom of container"),m.bindBottom()):c&&(m.set.scroll(l),m.save.lastScroll(e.top),m.save.elementScroll(l)):m.is.bottom()&&(e.bottom-a.height<=a.top?(m.debug("Bottom fixed rail has reached top of container"),m.setInitialPosition()):e.bottom>=r.bottom?(m.debug("Bottom fixed rail has reached bottom of container"),m.bindBottom()):c&&(m.set.scroll(l),m.save.lastScroll(e.top),m.save.elementScroll(l))):m.is.bottom()&&(f.pushing?m.is.bound()&&e.bottom<=r.bottom&&(m.debug("Fixing bottom attached element to bottom of browser."),m.fixBottom()):m.is.bound()&&e.top<=r.bottom-a.height&&(m.debug("Fixing bottom attached element to top of browser."),m.fixTop())))},bindTop:function(){m.debug("Binding element to top of parent container"),m.remove.offset(),k.css({left:"",top:"",marginBottom:""}).removeClass(g.fixed).removeClass(g.bottom).addClass(g.bound).addClass(g.top),f.onTop.call(I),f.onUnstick.call(I)},bindBottom:function(){m.debug("Binding element to bottom of parent container"),m.remove.offset(),k.css({left:"",top:""}).removeClass(g.fixed).removeClass(g.top).addClass(g.bound).addClass(g.bottom),f.onBottom.call(I),f.onUnstick.call(I)},setInitialPosition:function(){m.debug("Returning to initial position"),m.unfix(),m.unbind()},fixTop:function(){m.debug("Fixing element to top of page"),m.set.minimumSize(),m.set.offset(),k.css({left:m.cache.element.left,bottom:"",marginBottom:""}).removeClass(g.bound).removeClass(g.bottom).addClass(g.fixed).addClass(g.top),f.onStick.call(I)},fixBottom:function(){m.debug("Sticking element to bottom of page"),m.set.minimumSize(),m.set.offset(),k.css({left:m.cache.element.left,bottom:"",marginBottom:""}).removeClass(g.bound).removeClass(g.top).addClass(g.fixed).addClass(g.bottom),f.onStick.call(I)},unbind:function(){m.is.bound()&&(m.debug("Removing container bound position on element"),m.remove.offset(),k.removeClass(g.bound).removeClass(g.top).removeClass(g.bottom))},unfix:function(){m.is.fixed()&&(m.debug("Removing fixed position on element"),m.remove.offset(),k.removeClass(g.fixed).removeClass(g.top).removeClass(g.bottom),f.onUnstick.call(I))},reset:function(){m.debug("Reseting elements position"),m.unbind(),m.unfix(),m.resetCSS(),m.remove.offset(),m.remove.lastScroll()},resetCSS:function(){k.css({width:"",height:""}),o.css({height:""})},setting:function(t,i){if(e.isPlainObject(t))e.extend(!0,f,t);else{if(i===n)return f[t];f[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,m,t);else{if(i===n)return m[t];m[t]=i}},debug:function(){f.debug&&(f.performance?m.performance.log(arguments):(m.debug=Function.prototype.bind.call(console.info,console,f.name+":"),m.debug.apply(console,arguments)))},verbose:function(){f.verbose&&f.debug&&(f.performance?m.performance.log(arguments):(m.verbose=Function.prototype.bind.call(console.info,console,f.name+":"),m.verbose.apply(console,arguments)))},error:function(){m.error=Function.prototype.bind.call(console.error,console,f.name+":"),m.error.apply(console,arguments)},performance:{log:function(e){var t,i,n;f.performance&&(t=(new Date).getTime(),n=s||t,i=t-n,s=t,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:I,"Execution Time":i})),clearTimeout(m.performance.timer),m.performance.timer=setTimeout(m.performance.display,0)},display:function(){var t=f.name+":",i=0;s=!1,clearTimeout(m.performance.timer),e.each(l,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",r&&(t+=" '"+r+"'"),(console.group!==n||console.table!==n)&&l.length>0&&(console.groupCollapsed(t),console.table?console.table(l):e.each(l,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(t,i,o){var r,s,l,c=w;return i=i||d,o=I||o,"string"==typeof t&&c!==n&&(t=t.split(/[\. ]/),r=t.length-1,e.each(t,function(i,a){var o=i!=r?a+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(e.isPlainObject(c[o])&&i!=r)c=c[o];else{if(c[o]!==n)return s=c[o],!1;if(!e.isPlainObject(c[a])||i==r)return c[a]!==n?(s=c[a],!1):!1;c=c[a]}})),e.isFunction(s)?l=s.apply(o,i):s!==n&&(l=s),e.isArray(a)?a.push(l):a!==n?a=[a,l]:l!==n&&(a=l),s}},u?(w===n&&m.initialize(),m.invoke(c)):(w!==n&&w.invoke("destroy"),m.initialize())}),a!==n?a:this},e.fn.sticky.settings={name:"Sticky",namespace:"sticky",debug:!1,verbose:!0,performance:!0,pushing:!1,context:!1,scrollContext:t,offset:0,bottomOffset:0,jitter:5,observeChanges:!1,onReposition:function(){},onScroll:function(){},onStick:function(){},onUnstick:function(){},onTop:function(){},onBottom:function(){},error:{container:"Sticky element must be inside a relative container",visible:"Element is hidden, you must call refresh after element becomes visible",method:"The method you called is not defined.",invalidContext:"Context specified does not exist",elementSize:"Sticky element is larger than its container, cannot create sticky."},className:{bound:"bound",fixed:"fixed",supported:"native",top:"top",bottom:"bottom"}}}(jQuery,window,document);