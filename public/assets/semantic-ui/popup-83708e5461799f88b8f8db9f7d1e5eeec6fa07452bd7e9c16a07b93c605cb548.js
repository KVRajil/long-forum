/*!
 * # Semantic UI - Popup
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,i,n){"use strict";e.fn.popup=function(a){var o,r=e(this),s=e(i),l=e(t),c=e("body"),u=r.selector||"",d=!0,h=(new Date).getTime(),p=[],m=arguments[0],f="string"==typeof m,g=[].slice.call(arguments,1);return r.each(function(){var i,r,v,b,y,T=e.isPlainObject(a)?e.extend(!0,{},e.fn.popup.settings,a):e.extend({},e.fn.popup.settings),k=T.selector,C=T.className,E=T.error,w=T.metadata,D=T.namespace,I="."+T.namespace,S="module-"+D,_=e(this),R=e(T.context),x=T.target?e(T.target):_,O=0,A=!1,L=!1,N=this,F=_.data(S);y={initialize:function(){y.debug("Initializing",_),y.createID(),y.bind.events(),!y.exists()&&T.preserve&&y.create(),y.instantiate()},instantiate:function(){y.verbose("Storing instance",y),F=y,_.data(S,F)},refresh:function(){T.popup?i=e(T.popup).eq(0):T.inline&&(i=x.nextAll(k.popup).eq(0),T.popup=i),T.popup?(i.addClass(C.loading),r=y.get.offsetParent(),i.removeClass(C.loading),T.movePopup&&y.has.popup()&&y.get.offsetParent(i)[0]!==r[0]&&(y.debug("Moving popup to the same offset parent as activating element"),i.detach().appendTo(r))):r=T.inline?y.get.offsetParent(x):y.has.popup()?y.get.offsetParent(i):c,r.is("html")&&r[0]!==c[0]&&(y.debug("Setting page as offset parent"),r=c),y.get.variation()&&y.set.variation()},reposition:function(){y.refresh(),y.set.position()},destroy:function(){y.debug("Destroying previous module"),i&&!T.preserve&&y.removePopup(),clearTimeout(y.hideTimer),clearTimeout(y.showTimer),l.off(v),_.off(I).removeData(S)},event:{start:function(t){var i=e.isPlainObject(T.delay)?T.delay.show:T.delay;clearTimeout(y.hideTimer),L||(y.showTimer=setTimeout(y.show,i))},end:function(){var t=e.isPlainObject(T.delay)?T.delay.hide:T.delay;clearTimeout(y.showTimer),y.hideTimer=setTimeout(y.hide,t)},touchstart:function(e){L=!0,y.show()},resize:function(){y.is.visible()&&y.set.position()},hideGracefully:function(t){t&&0===e(t.target).closest(k.popup).length?(y.debug("Click occurred outside popup hiding popup"),y.hide()):y.debug("Click was inside popup, keeping popup open")}},create:function(){var t=y.get.html(),n=y.get.title(),a=y.get.content();t||a||n?(y.debug("Creating pop-up html"),t||(t=T.templates.popup({title:n,content:a})),i=e("<div/>").addClass(C.popup).data(w.activator,_).html(t),T.inline?(y.verbose("Inserting popup element inline",i),i.insertAfter(_)):(y.verbose("Appending popup element to body",i),i.appendTo(R)),y.refresh(),y.set.variation(),T.hoverable&&y.bind.popup(),T.onCreate.call(i,N)):0!==x.next(k.popup).length?(y.verbose("Pre-existing popup found"),T.inline=!0,T.popups=x.next(k.popup).data(w.activator,_),y.refresh(),T.hoverable&&y.bind.popup()):T.popup?(e(T.popup).data(w.activator,_),y.verbose("Used popup specified in settings"),y.refresh(),T.hoverable&&y.bind.popup()):y.debug("No content specified skipping display",N)},createID:function(){b=(Math.random().toString(16)+"000000000").substr(2,8),v="."+b,y.verbose("Creating unique id for element",b)},toggle:function(){y.debug("Toggling pop-up"),y.is.hidden()?(y.debug("Popup is hidden, showing pop-up"),y.unbind.close(),y.show()):(y.debug("Popup is visible, hiding pop-up"),y.hide())},show:function(e){if(e=e||function(){},y.debug("Showing pop-up",T.transition),y.is.hidden()&&(!y.is.active()||!y.is.dropdown())){if(y.exists()||y.create(),T.onShow.call(i,N)===!1)return void y.debug("onShow callback returned false, cancelling popup animation");T.preserve||T.popup||y.refresh(),i&&y.set.position()&&(y.save.conditions(),T.exclusive&&y.hideAll(),y.animate.show(e))}},hide:function(e){if(e=e||function(){},y.is.visible()||y.is.animating()){if(T.onHide.call(i,N)===!1)return void y.debug("onHide callback returned false, cancelling popup animation");y.remove.visible(),y.unbind.close(),y.restore.conditions(),y.animate.hide(e)}},hideAll:function(){e(k.popup).filter("."+C.visible).each(function(){e(this).data(w.activator).popup("hide")})},exists:function(){return i?T.inline||T.popup?y.has.popup():i.closest(R).length>=1?!0:!1:!1},removePopup:function(){y.has.popup()&&!T.popup&&(y.debug("Removing popup",i),i.remove(),i=n,T.onRemove.call(i,N))},save:{conditions:function(){y.cache={title:_.attr("title")},y.cache.title&&_.removeAttr("title"),y.verbose("Saving original attributes",y.cache.title)}},restore:{conditions:function(){return y.cache&&y.cache.title&&(_.attr("title",y.cache.title),y.verbose("Restoring original attributes",y.cache.title)),!0}},animate:{show:function(t){t=e.isFunction(t)?t:function(){},T.transition&&e.fn.transition!==n&&_.transition("is supported")?(y.set.visible(),i.transition({animation:T.transition+" in",queue:!1,debug:T.debug,verbose:T.verbose,duration:T.duration,onComplete:function(){y.bind.close(),t.call(i,N),T.onVisible.call(i,N)}})):y.error(E.noTransition)},hide:function(t){return t=e.isFunction(t)?t:function(){},y.debug("Hiding pop-up"),T.onHide.call(i,N)===!1?void y.debug("onHide callback returned false, cancelling popup animation"):void(T.transition&&e.fn.transition!==n&&_.transition("is supported")?i.transition({animation:T.transition+" out",queue:!1,duration:T.duration,debug:T.debug,verbose:T.verbose,onComplete:function(){y.reset(),t.call(i,N),T.onHidden.call(i,N)}}):y.error(E.noTransition))}},get:{html:function(){return _.removeData(w.html),_.data(w.html)||T.html},title:function(){return _.removeData(w.title),_.data(w.title)||T.title},content:function(){return _.removeData(w.content),_.data(w.content)||_.attr("title")||T.content},variation:function(){return _.removeData(w.variation),_.data(w.variation)||T.variation},popupOffset:function(){return i.offset()},calculations:function(){var e,n=x[0],a=T.inline||T.popup?x.position():x.offset(),o={};return o={target:{element:x[0],width:x.outerWidth(),height:x.outerHeight(),top:a.top,left:a.left,margin:{}},popup:{width:i.outerWidth(),height:i.outerHeight()},parent:{width:r.outerWidth(),height:r.outerHeight()},screen:{scroll:{top:l.scrollTop(),left:l.scrollLeft()},width:l.width(),height:l.height()}},T.setFluidWidth&&y.is.fluid()&&(o.container={width:i.parent().outerWidth()},o.popup.width=o.container.width),o.target.margin.top=T.inline?parseInt(t.getComputedStyle(n).getPropertyValue("margin-top"),10):0,o.target.margin.left=T.inline?y.is.rtl()?parseInt(t.getComputedStyle(n).getPropertyValue("margin-right"),10):parseInt(t.getComputedStyle(n).getPropertyValue("margin-left"),10):0,e=o.screen,o.boundary={top:e.scroll.top,bottom:e.scroll.top+e.height,left:e.scroll.left,right:e.scroll.left+e.width},o},id:function(){return b},startEvent:function(){return"hover"==T.on?"mouseenter":"focus"==T.on?"focus":!1},scrollEvent:function(){return"scroll"},endEvent:function(){return"hover"==T.on?"mouseleave":"focus"==T.on?"blur":!1},distanceFromBoundary:function(e,t){var i,n,a={};return e=e||y.get.offset(),t=t||y.get.calculations(),i=t.popup,n=t.boundary,e&&(a={top:e.top-n.top,left:e.left-n.left,right:n.right-(e.left+i.width),bottom:n.bottom-(e.top+i.height)},y.verbose("Distance from boundaries determined",e,a)),a},offsetParent:function(t){var i=t!==n?t[0]:_[0],a=i.parentNode,o=e(a);if(a)for(var r="none"===o.css("transform"),s="static"===o.css("position"),l=o.is("html");a&&!l&&s&&r;)a=a.parentNode,o=e(a),r="none"===o.css("transform"),s="static"===o.css("position"),l=o.is("html");return o&&o.length>0?o:e()},positions:function(){return{"top left":!1,"top center":!1,"top right":!1,"bottom left":!1,"bottom center":!1,"bottom right":!1,"left center":!1,"right center":!1}},nextPosition:function(e){var t=e.split(" "),i=t[0],n=t[1],a={top:"bottom",bottom:"top",left:"right",right:"left"},o={left:"center",center:"right",right:"left"},r={"top left":"top center","top center":"top right","top right":"right center","right center":"bottom right","bottom right":"bottom center","bottom center":"bottom left","bottom left":"left center","left center":"top left"},s="top"==i||"bottom"==i,l=!1,c=!1,u=!1;return A||(y.verbose("All available positions available"),A=y.get.positions()),y.debug("Recording last position tried",e),A[e]=!0,"opposite"===T.prefer&&(u=[a[i],n],u=u.join(" "),l=A[u]===!0,y.debug("Trying opposite strategy",u)),"adjacent"===T.prefer&&s&&(u=[i,o[n]],u=u.join(" "),c=A[u]===!0,y.debug("Trying adjacent strategy",u)),(c||l)&&(y.debug("Using backup position",u),u=r[e]),u}},set:{position:function(e,t){if(0===x.length||0===i.length)return void y.error(E.notFound);var a,o,r,s,l,c,u,d;if(t=t||y.get.calculations(),e=e||_.data(w.position)||T.position,a=_.data(w.offset)||T.offset,o=T.distanceAway,r=t.target,s=t.popup,l=t.parent,0===r.width&&0===r.height)return y.debug("Popup target is hidden, no action taken"),!1;switch(T.inline&&(y.debug("Adding margin to calculation",r.margin),"left center"==e||"right center"==e?(a+=r.margin.top,o+=-r.margin.left):"top left"==e||"top center"==e||"top right"==e?(a+=r.margin.left,o-=r.margin.top):(a+=r.margin.left,o+=r.margin.top)),y.debug("Determining popup position from calculations",e,t),y.is.rtl()&&(e=e.replace(/left|right/g,function(e){return"left"==e?"right":"left"}),y.debug("RTL: Popup position updated",e)),O==T.maxSearchDepth&&"string"==typeof T.lastResort&&(e=T.lastResort),e){case"top left":c={top:"auto",bottom:l.height-r.top+o,left:r.left+a,right:"auto"};break;case"top center":c={bottom:l.height-r.top+o,left:r.left+r.width/2-s.width/2+a,top:"auto",right:"auto"};break;case"top right":c={bottom:l.height-r.top+o,right:l.width-r.left-r.width-a,top:"auto",left:"auto"};break;case"left center":c={top:r.top+r.height/2-s.height/2+a,right:l.width-r.left+o,left:"auto",bottom:"auto"};break;case"right center":c={top:r.top+r.height/2-s.height/2+a,left:r.left+r.width+o,bottom:"auto",right:"auto"};break;case"bottom left":c={top:r.top+r.height+o,left:r.left+a,bottom:"auto",right:"auto"};break;case"bottom center":c={top:r.top+r.height+o,left:r.left+r.width/2-s.width/2+a,bottom:"auto",right:"auto"};break;case"bottom right":c={top:r.top+r.height+o,right:l.width-r.left-r.width-a,left:"auto",bottom:"auto"}}if(c===n&&y.error(E.invalidPosition,e),y.debug("Calculated popup positioning values",c),i.css(c).removeClass(C.position).addClass(e).addClass(C.loading),u=y.get.popupOffset(),d=y.get.distanceFromBoundary(u,t),y.is.offstage(d,e)){if(y.debug("Position is outside viewport",e),O<T.maxSearchDepth)return O++,e=y.get.nextPosition(e),y.debug("Trying new position",e),i?y.set.position(e,t):!1;if(!T.lastResort)return y.debug("Popup could not find a position to display",i),y.error(E.cannotPlace,N),y.remove.attempts(),y.remove.loading(),y.reset(),!1;y.debug("No position found, showing with last position")}return y.debug("Position is on stage",e),y.remove.attempts(),y.remove.loading(),T.setFluidWidth&&y.is.fluid()&&y.set.fluidWidth(t),!0},fluidWidth:function(e){e=e||y.get.calculations(),y.debug("Automatically setting element width to parent width",e.parent.width),i.css("width",e.container.width)},variation:function(e){e=e||y.get.variation(),e&&y.has.popup()&&(y.verbose("Adding variation to popup",e),i.addClass(e))},visible:function(){_.addClass(C.visible)}},remove:{loading:function(){i.removeClass(C.loading)},variation:function(e){e=e||y.get.variation(),e&&(y.verbose("Removing variation",e),i.removeClass(e))},visible:function(){_.removeClass(C.visible)},attempts:function(){y.verbose("Resetting all searched positions"),O=0,A=!1}},bind:{events:function(){y.debug("Binding popup events to module"),"click"==T.on&&_.on("click"+I,y.toggle),"hover"==T.on&&d&&_.on("touchstart"+I,y.event.touchstart),y.get.startEvent()&&_.on(y.get.startEvent()+I,y.event.start).on(y.get.endEvent()+I,y.event.end),T.target&&y.debug("Target set to element",x),l.on("resize"+v,y.event.resize)},popup:function(){y.verbose("Allowing hover events on popup to prevent closing"),i&&y.has.popup()&&i.on("mouseenter"+I,y.event.start).on("mouseleave"+I,y.event.end)},close:function(){(T.hideOnScroll===!0||"auto"==T.hideOnScroll&&"click"!=T.on)&&(s.one(y.get.scrollEvent()+v,y.event.hideGracefully),R.one(y.get.scrollEvent()+v,y.event.hideGracefully)),"hover"==T.on&&L&&(y.verbose("Binding popup close event to document"),s.on("touchstart"+v,function(e){y.verbose("Touched away from popup"),y.event.hideGracefully.call(N,e)})),"click"==T.on&&T.closable&&(y.verbose("Binding popup close event to document"),s.on("click"+v,function(e){y.verbose("Clicked away from popup"),y.event.hideGracefully.call(N,e)}))}},unbind:{close:function(){(T.hideOnScroll===!0||"auto"==T.hideOnScroll&&"click"!=T.on)&&(s.off("scroll"+v,y.hide),R.off("scroll"+v,y.hide)),"hover"==T.on&&L&&(s.off("touchstart"+v),L=!1),"click"==T.on&&T.closable&&(y.verbose("Removing close event from document"),s.off("click"+v))}},has:{popup:function(){return i&&i.length>0}},is:{offstage:function(t,i){var n=[];return e.each(t,function(e,t){t<-T.jitter&&(y.debug("Position exceeds allowable distance from edge",e,t,i),n.push(e))}),n.length>0?!0:!1},active:function(){return _.hasClass(C.active)},animating:function(){return i&&i.hasClass(C.animating)},fluid:function(){return i&&i.hasClass(C.fluid)},visible:function(){return i&&i.hasClass(C.visible)},dropdown:function(){return _.hasClass(C.dropdown)},hidden:function(){return!y.is.visible()},rtl:function(){return"rtl"==_.css("direction")}},reset:function(){y.remove.visible(),T.preserve?e.fn.transition!==n&&i.transition("remove transition"):y.removePopup()},setting:function(t,i){if(e.isPlainObject(t))e.extend(!0,T,t);else{if(i===n)return T[t];T[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,y,t);else{if(i===n)return y[t];y[t]=i}},debug:function(){T.debug&&(T.performance?y.performance.log(arguments):(y.debug=Function.prototype.bind.call(console.info,console,T.name+":"),y.debug.apply(console,arguments)))},verbose:function(){T.verbose&&T.debug&&(T.performance?y.performance.log(arguments):(y.verbose=Function.prototype.bind.call(console.info,console,T.name+":"),y.verbose.apply(console,arguments)))},error:function(){y.error=Function.prototype.bind.call(console.error,console,T.name+":"),y.error.apply(console,arguments)},performance:{log:function(e){var t,i,n;T.performance&&(t=(new Date).getTime(),n=h||t,i=t-n,h=t,p.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:N,"Execution Time":i})),clearTimeout(y.performance.timer),y.performance.timer=setTimeout(y.performance.display,500)},display:function(){var t=T.name+":",i=0;h=!1,clearTimeout(y.performance.timer),e.each(p,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",u&&(t+=" '"+u+"'"),(console.group!==n||console.table!==n)&&p.length>0&&(console.groupCollapsed(t),console.table?console.table(p):e.each(p,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),p=[]}},invoke:function(t,i,a){var r,s,l,c=F;return i=i||g,a=N||a,"string"==typeof t&&c!==n&&(t=t.split(/[\. ]/),r=t.length-1,e.each(t,function(i,a){var o=i!=r?a+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(e.isPlainObject(c[o])&&i!=r)c=c[o];else{if(c[o]!==n)return s=c[o],!1;if(!e.isPlainObject(c[a])||i==r)return c[a]!==n?(s=c[a],!1):!1;c=c[a]}})),e.isFunction(s)?l=s.apply(a,i):s!==n&&(l=s),e.isArray(o)?o.push(l):o!==n?o=[o,l]:l!==n&&(o=l),s}},f?(F===n&&y.initialize(),y.invoke(m)):(F!==n&&F.invoke("destroy"),y.initialize())}),o!==n?o:this},e.fn.popup.settings={name:"Popup",debug:!1,verbose:!1,performance:!0,namespace:"popup",onCreate:function(){},onRemove:function(){},onShow:function(){},onVisible:function(){},onHide:function(){},onHidden:function(){},on:"hover",addTouchEvents:!0,position:"top left",variation:"",movePopup:!0,target:!1,popup:!1,inline:!1,preserve:!1,hoverable:!1,content:!1,html:!1,title:!1,closable:!0,hideOnScroll:"auto",exclusive:!1,context:"body",prefer:"opposite",lastResort:!1,delay:{show:50,hide:70},setFluidWidth:!0,duration:200,transition:"scale",distanceAway:0,jitter:2,offset:0,maxSearchDepth:15,error:{invalidPosition:"The position you specified is not a valid position",cannotPlace:"Popup does not fit within the boundaries of the viewport",method:"The method you called is not defined.",noTransition:"This module requires ui transitions <https://github.com/Semantic-Org/UI-Transition>",notFound:"The target or popup you specified does not exist on the page"},metadata:{activator:"activator",content:"content",html:"html",offset:"offset",position:"position",title:"title",variation:"variation"},className:{active:"active",animating:"animating",dropdown:"dropdown",fluid:"fluid",loading:"loading",popup:"ui popup",position:"top left center bottom right",visible:"visible"},selector:{popup:".ui.popup"},templates:{escape:function(e){var t=/[&<>"'`]/g,i=/[&<>"'`]/,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},a=function(e){return n[e]};return i.test(e)?e.replace(t,a):e},popup:function(t){var i="",a=e.fn.popup.settings.templates.escape;return typeof t!==n&&(typeof t.title!==n&&t.title&&(t.title=a(t.title),i+='<div class="header">'+t.title+"</div>"),typeof t.content!==n&&t.content&&(t.content=a(t.content),i+='<div class="content">'+t.content+"</div>")),i}}}}(jQuery,window,document);