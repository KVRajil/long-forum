/*!
 * # Semantic UI - Modal
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,i,n){"use strict";e.fn.modal=function(a){var o,r=e(this),s=e(t),l=e(i),c=e("body"),u=r.selector||"",d=(new Date).getTime(),h=[],p=arguments[0],m="string"==typeof p,f=[].slice.call(arguments,1),g=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)};return r.each(function(){var r,v,b,y,T,k,C,E,w,D=e.isPlainObject(a)?e.extend(!0,{},e.fn.modal.settings,a):e.extend({},e.fn.modal.settings),I=D.selector,S=D.className,_=D.namespace,R=D.error,x="."+_,O="module-"+_,A=e(this),L=e(D.context),N=A.find(I.close),F=this,P=A.data(O);w={initialize:function(){w.verbose("Initializing dimmer",L),w.create.id(),w.create.dimmer(),w.refreshModals(),w.bind.events(),D.observeChanges&&w.observeChanges(),w.instantiate()},instantiate:function(){w.verbose("Storing instance of modal"),P=w,A.data(O,P)},create:{dimmer:function(){var t={debug:D.debug,dimmerName:"modals",duration:{show:D.duration,hide:D.duration}},i=e.extend(!0,t,D.dimmerSettings);return D.inverted&&(i.variation=i.variation!==n?i.variation+" inverted":"inverted"),e.fn.dimmer===n?void w.error(R.dimmer):(w.debug("Creating dimmer with settings",i),y=L.dimmer(i),D.detachable?(w.verbose("Modal is detachable, moving content into dimmer"),y.dimmer("add content",A)):w.set.undetached(),D.blurring&&y.addClass(S.blurring),void(T=y.dimmer("get dimmer")))},id:function(){C=(Math.random().toString(16)+"000000000").substr(2,8),k="."+C,w.verbose("Creating unique id for element",C)}},destroy:function(){w.verbose("Destroying previous modal"),A.removeData(O).off(x),s.off(k),N.off(x),L.dimmer("destroy")},observeChanges:function(){"MutationObserver"in t&&(E=new MutationObserver(function(e){w.debug("DOM tree modified, refreshing"),w.refresh()}),E.observe(F,{childList:!0,subtree:!0}),w.debug("Setting up mutation observer",E))},refresh:function(){w.remove.scrolling(),w.cacheSizes(),w.set.screenHeight(),w.set.type(),w.set.position()},refreshModals:function(){v=A.siblings(I.modal),r=v.add(A)},attachEvents:function(t,i){var n=e(t);i=e.isFunction(w[i])?w[i]:w.toggle,n.length>0?(w.debug("Attaching modal events to element",t,i),n.off(x).on("click"+x,i)):w.error(R.notFound,t)},bind:{events:function(){w.verbose("Attaching events"),A.on("click"+x,I.close,w.event.close).on("click"+x,I.approve,w.event.approve).on("click"+x,I.deny,w.event.deny),s.on("resize"+k,w.event.resize)}},get:{id:function(){return(Math.random().toString(16)+"000000000").substr(2,8)}},event:{approve:function(){return D.onApprove.call(F,e(this))===!1?void w.verbose("Approve callback returned false cancelling hide"):void w.hide()},deny:function(){return D.onDeny.call(F,e(this))===!1?void w.verbose("Deny callback returned false cancelling hide"):void w.hide()},close:function(){w.hide()},click:function(t){var n=e(t.target),a=n.closest(I.modal).length>0,o=e.contains(i.documentElement,t.target);!a&&o&&(w.debug("Dimmer clicked, hiding all modals"),w.is.active()&&(w.remove.clickaway(),D.allowMultiple?w.hide():w.hideAll()))},debounce:function(e,t){clearTimeout(w.timer),w.timer=setTimeout(e,t)},keyboard:function(e){var t=e.which,i=27;t==i&&(D.closable?(w.debug("Escape key pressed hiding modal"),w.hide()):w.debug("Escape key pressed, but closable is set to false"),e.preventDefault())},resize:function(){y.dimmer("is active")&&g(w.refresh)}},toggle:function(){w.is.active()||w.is.animating()?w.hide():w.show()},show:function(t){t=e.isFunction(t)?t:function(){},w.refreshModals(),w.showModal(t)},hide:function(t){t=e.isFunction(t)?t:function(){},w.refreshModals(),w.hideModal(t)},showModal:function(t){t=e.isFunction(t)?t:function(){},w.is.animating()||!w.is.active()?(w.showDimmer(),w.cacheSizes(),w.set.position(),w.set.screenHeight(),w.set.type(),w.set.clickaway(),!D.allowMultiple&&w.others.active()?w.hideOthers(w.showModal):(D.onShow.call(F),D.transition&&e.fn.transition!==n&&A.transition("is supported")?(w.debug("Showing modal with css animations"),A.transition({debug:D.debug,animation:D.transition+" in",queue:D.queue,duration:D.duration,useFailSafe:!0,onComplete:function(){D.onVisible.apply(F),w.add.keyboardShortcuts(),w.save.focus(),w.set.active(),D.autofocus&&w.set.autofocus(),t()}})):w.error(R.noTransition))):w.debug("Modal is already visible")},hideModal:function(t,i){t=e.isFunction(t)?t:function(){},w.debug("Hiding modal"),D.onHide.call(F),(w.is.animating()||w.is.active())&&(D.transition&&e.fn.transition!==n&&A.transition("is supported")?(w.remove.active(),A.transition({debug:D.debug,animation:D.transition+" out",queue:D.queue,duration:D.duration,useFailSafe:!0,onStart:function(){w.others.active()||i||w.hideDimmer(),w.remove.keyboardShortcuts()},onComplete:function(){D.onHidden.call(F),w.restore.focus(),t()}})):w.error(R.noTransition))},showDimmer:function(){y.dimmer("is animating")||!y.dimmer("is active")?(w.debug("Showing dimmer"),y.dimmer("show")):w.debug("Dimmer already visible")},hideDimmer:function(){return y.dimmer("is animating")||y.dimmer("is active")?void y.dimmer("hide",function(){w.remove.clickaway(),w.remove.screenHeight()}):void w.debug("Dimmer is not visible cannot hide")},hideAll:function(t){var i=r.filter("."+S.active+", ."+S.animating);t=e.isFunction(t)?t:function(){},i.length>0&&(w.debug("Hiding all visible modals"),w.hideDimmer(),i.modal("hide modal",t))},hideOthers:function(t){var i=v.filter("."+S.active+", ."+S.animating);t=e.isFunction(t)?t:function(){},i.length>0&&(w.debug("Hiding other modals",v),i.modal("hide modal",t,!0))},others:{active:function(){return v.filter("."+S.active).length>0},animating:function(){return v.filter("."+S.animating).length>0}},add:{keyboardShortcuts:function(){w.verbose("Adding keyboard shortcuts"),l.on("keyup"+x,w.event.keyboard)}},save:{focus:function(){b=e(i.activeElement).blur()}},restore:{focus:function(){b&&b.length>0&&b.focus()}},remove:{active:function(){A.removeClass(S.active)},clickaway:function(){D.closable&&T.off("click"+k)},bodyStyle:function(){""===c.attr("style")&&(w.verbose("Removing style attribute"),c.removeAttr("style"))},screenHeight:function(){w.debug("Removing page height"),c.css("height","")},keyboardShortcuts:function(){w.verbose("Removing keyboard shortcuts"),l.off("keyup"+x)},scrolling:function(){y.removeClass(S.scrolling),A.removeClass(S.scrolling)}},cacheSizes:function(){var a=A.outerHeight();(w.cache===n||0!==a)&&(w.cache={pageHeight:e(i).outerHeight(),height:a+D.offset,contextHeight:"body"==D.context?e(t).height():y.height()}),w.debug("Caching modal and container sizes",w.cache)},can:{fit:function(){return w.cache.height+2*D.padding<w.cache.contextHeight}},is:{active:function(){return A.hasClass(S.active)},animating:function(){return A.transition("is supported")?A.transition("is animating"):A.is(":visible")},scrolling:function(){return y.hasClass(S.scrolling)},modernBrowser:function(){return!(t.ActiveXObject||"ActiveXObject"in t)}},set:{autofocus:function(){var e=A.find(":input").filter(":visible"),t=e.filter("[autofocus]"),i=t.length>0?t.first():e.first();i.length>0&&i.focus()},clickaway:function(){D.closable&&T.on("click"+k,w.event.click)},screenHeight:function(){w.can.fit()?c.css("height",""):(w.debug("Modal is taller than page content, resizing page height"),c.css("height",w.cache.height+2*D.padding))},active:function(){A.addClass(S.active)},scrolling:function(){y.addClass(S.scrolling),A.addClass(S.scrolling)},type:function(){w.can.fit()?(w.verbose("Modal fits on screen"),w.others.active()||w.others.animating()||w.remove.scrolling()):(w.verbose("Modal cannot fit on screen setting to scrolling"),w.set.scrolling())},position:function(){w.verbose("Centering modal on page",w.cache),w.can.fit()?A.css({top:"",marginTop:-(w.cache.height/2)}):A.css({marginTop:"",top:l.scrollTop()})},undetached:function(){y.addClass(S.undetached)}},setting:function(t,i){if(w.debug("Changing setting",t,i),e.isPlainObject(t))e.extend(!0,D,t);else{if(i===n)return D[t];D[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,w,t);else{if(i===n)return w[t];w[t]=i}},debug:function(){D.debug&&(D.performance?w.performance.log(arguments):(w.debug=Function.prototype.bind.call(console.info,console,D.name+":"),w.debug.apply(console,arguments)))},verbose:function(){D.verbose&&D.debug&&(D.performance?w.performance.log(arguments):(w.verbose=Function.prototype.bind.call(console.info,console,D.name+":"),w.verbose.apply(console,arguments)))},error:function(){w.error=Function.prototype.bind.call(console.error,console,D.name+":"),w.error.apply(console,arguments)},performance:{log:function(e){var t,i,n;D.performance&&(t=(new Date).getTime(),n=d||t,i=t-n,d=t,h.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:F,"Execution Time":i})),clearTimeout(w.performance.timer),w.performance.timer=setTimeout(w.performance.display,500)},display:function(){var t=D.name+":",i=0;d=!1,clearTimeout(w.performance.timer),e.each(h,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",u&&(t+=" '"+u+"'"),(console.group!==n||console.table!==n)&&h.length>0&&(console.groupCollapsed(t),console.table?console.table(h):e.each(h,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),h=[]}},invoke:function(t,i,a){var r,s,l,c=P;return i=i||f,a=F||a,"string"==typeof t&&c!==n&&(t=t.split(/[\. ]/),r=t.length-1,e.each(t,function(i,a){var o=i!=r?a+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(e.isPlainObject(c[o])&&i!=r)c=c[o];else{if(c[o]!==n)return s=c[o],!1;if(!e.isPlainObject(c[a])||i==r)return c[a]!==n?(s=c[a],!1):!1;c=c[a]}})),e.isFunction(s)?l=s.apply(a,i):s!==n&&(l=s),e.isArray(o)?o.push(l):o!==n?o=[o,l]:l!==n&&(o=l),s}},m?(P===n&&w.initialize(),w.invoke(p)):(P!==n&&P.invoke("destroy"),w.initialize())}),o!==n?o:this},e.fn.modal.settings={name:"Modal",namespace:"modal",debug:!1,verbose:!1,performance:!0,observeChanges:!1,allowMultiple:!1,detachable:!0,closable:!0,autofocus:!0,inverted:!1,blurring:!1,dimmerSettings:{closable:!1,useCSS:!0},context:"body",queue:!1,duration:500,offset:0,transition:"scale",padding:50,onShow:function(){},onVisible:function(){},onHide:function(){},onHidden:function(){},onApprove:function(){return!0},onDeny:function(){return!0},selector:{close:"> .close",approve:".actions .positive, .actions .approve, .actions .ok",deny:".actions .negative, .actions .deny, .actions .cancel",modal:".ui.modal"},error:{dimmer:"UI Dimmer, a required component is not included in this page",method:"The method you called is not defined.",notFound:"The element you specified could not be found"},className:{active:"active",animating:"animating",blurring:"blurring",scrolling:"scrolling",undetached:"undetached"}}}(jQuery,window,document);