/*!
 * # Semantic UI - Visibility
 * http://github.com/semantic-org/semantic-ui/
 *
 *
 * Copyright 2015 Contributors
 * Released under the MIT license
 * http://opensource.org/licenses/MIT
 *
 */
!function(e,t,i,n){"use strict";e.fn.visibility=function(a){var o,r=e(this),s=r.selector||"",l=(new Date).getTime(),c=[],u=arguments[0],d="string"==typeof u,h=[].slice.call(arguments,1);return r.each(function(){var r,p,m,f=e.isPlainObject(a)?e.extend(!0,{},e.fn.visibility.settings,a):e.extend({},e.fn.visibility.settings),g=f.className,v=f.namespace,b=f.error,y=f.metadata,T="."+v,k="module-"+v,C=e(t),E=e(this),w=e(f.context),D=(E.selector||"",E.data(k)),I=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)},S=this,_=!1;m={initialize:function(){m.debug("Initializing",f),m.setup.cache(),m.should.trackChanges()&&("image"==f.type&&m.setup.image(),"fixed"==f.type&&m.setup.fixed(),f.observeChanges&&m.observeChanges(),m.bind.events()),m.save.position(),m.is.visible()||m.error(b.visible,E),f.initialCheck&&m.checkVisibility(),m.instantiate()},instantiate:function(){m.debug("Storing instance",m),E.data(k,m),D=m},destroy:function(){m.verbose("Destroying previous module"),p&&p.disconnect(),C.off("load"+T,m.event.load).off("resize"+T,m.event.resize),w.off("scrollchange"+T,m.event.scrollchange),E.off(T).removeData(k)},observeChanges:function(){"MutationObserver"in t&&(p=new MutationObserver(function(e){m.verbose("DOM tree modified, updating visibility calculations"),m.timer=setTimeout(function(){m.verbose("DOM tree modified, updating sticky menu"),m.refresh()},100)}),p.observe(S,{childList:!0,subtree:!0}),m.debug("Setting up mutation observer",p))},bind:{events:function(){m.verbose("Binding visibility events to scroll and resize"),f.refreshOnLoad&&C.on("load"+T,m.event.load),C.on("resize"+T,m.event.resize),w.off("scroll"+T).on("scroll"+T,m.event.scroll).on("scrollchange"+T,m.event.scrollchange)}},event:{resize:function(){m.debug("Window resized"),f.refreshOnResize&&I(m.refresh)},load:function(){m.debug("Page finished loading"),I(m.refresh)},scroll:function(){f.throttle?(clearTimeout(m.timer),m.timer=setTimeout(function(){w.triggerHandler("scrollchange"+T,[w.scrollTop()])},f.throttle)):I(function(){w.triggerHandler("scrollchange"+T,[w.scrollTop()])})},scrollchange:function(e,t){m.checkVisibility(t)}},precache:function(t,n){t instanceof Array||(t=[t]);for(var a=t.length,o=0,r=[],s=i.createElement("img"),l=function(){o++,o>=t.length&&e.isFunction(n)&&n()};a--;)s=i.createElement("img"),s.onload=l,s.onerror=l,s.src=t[a],r.push(s)},enableCallbacks:function(){m.debug("Allowing callbacks to occur"),_=!1},disableCallbacks:function(){m.debug("Disabling all callbacks temporarily"),_=!0},should:{trackChanges:function(){return d?(m.debug("One time query, no need to bind events"),!1):(m.debug("Callbacks being attached"),!0)}},setup:{cache:function(){m.cache={occurred:{},screen:{},element:{}}},image:function(){var e=E.data(y.src);e&&(m.verbose("Lazy loading image",e),f.once=!0,f.observeChanges=!1,f.onOnScreen=function(){m.debug("Image on screen",S),m.precache(e,function(){m.set.image(e)})})},fixed:function(){m.debug("Setting up fixed"),f.once=!1,f.observeChanges=!1,f.initialCheck=!0,f.refreshOnLoad=!0,a.transition||(f.transition=!1),m.create.placeholder(),m.debug("Added placeholder",r),f.onTopPassed=function(){m.debug("Element passed, adding fixed position",E),m.show.placeholder(),m.set.fixed(),f.transition&&e.fn.transition!==n&&E.transition(f.transition,f.duration)},f.onTopPassedReverse=function(){m.debug("Element returned to position, removing fixed",E),m.hide.placeholder(),m.remove.fixed()}}},create:{placeholder:function(){m.verbose("Creating fixed position placeholder"),r=E.clone(!1).css("display","none").addClass(g.placeholder).insertAfter(E)}},show:{placeholder:function(){m.verbose("Showing placeholder"),r.css("display","block").css("visibility","hidden")}},hide:{placeholder:function(){m.verbose("Hiding placeholder"),r.css("display","none").css("visibility","")}},set:{fixed:function(){m.verbose("Setting element to fixed position"),E.addClass(g.fixed).css({position:"fixed",top:f.offset+"px",left:"auto",zIndex:"1"})},image:function(t){E.attr("src",t),f.transition?e.fn.transition!==n?E.transition(f.transition,f.duration):E.fadeIn(f.duration):E.show()}},is:{onScreen:function(){var e=m.get.elementCalculations();return e.onScreen},offScreen:function(){var e=m.get.elementCalculations();return e.offScreen},visible:function(){return m.cache&&m.cache.element?!(0===m.cache.element.width&&0===m.cache.element.offset.top):!1}},refresh:function(){m.debug("Refreshing constants (width/height)"),"fixed"==f.type&&(m.remove.fixed(),m.remove.occurred()),m.reset(),m.save.position(),f.checkOnRefresh&&m.checkVisibility(),f.onRefresh.call(S)},reset:function(){m.verbose("Reseting all cached values"),e.isPlainObject(m.cache)&&(m.cache.screen={},m.cache.element={})},checkVisibility:function(e){m.verbose("Checking visibility of element",m.cache.element),!_&&m.is.visible()&&(m.save.scroll(e),m.save.calculations(),m.passed(),m.passingReverse(),m.topVisibleReverse(),m.bottomVisibleReverse(),m.topPassedReverse(),m.bottomPassedReverse(),m.onScreen(),m.offScreen(),m.passing(),m.topVisible(),m.bottomVisible(),m.topPassed(),m.bottomPassed(),f.onUpdate&&f.onUpdate.call(S,m.get.elementCalculations()))},passed:function(t,i){var a=m.get.elementCalculations();if(t&&i)f.onPassed[t]=i;else{if(t!==n)return m.get.pixelsPassed(t)>a.pixelsPassed;a.passing&&e.each(f.onPassed,function(e,t){a.bottomVisible||a.pixelsPassed>m.get.pixelsPassed(e)?m.execute(t,e):f.once||m.remove.occurred(t)})}},onScreen:function(e){var t=m.get.elementCalculations(),i=e||f.onOnScreen,a="onScreen";return e&&(m.debug("Adding callback for onScreen",e),f.onOnScreen=e),t.onScreen?m.execute(i,a):f.once||m.remove.occurred(a),e!==n?t.onOnScreen:void 0},offScreen:function(e){var t=m.get.elementCalculations(),i=e||f.onOffScreen,a="offScreen";return e&&(m.debug("Adding callback for offScreen",e),f.onOffScreen=e),t.offScreen?m.execute(i,a):f.once||m.remove.occurred(a),e!==n?t.onOffScreen:void 0},passing:function(e){var t=m.get.elementCalculations(),i=e||f.onPassing,a="passing";return e&&(m.debug("Adding callback for passing",e),f.onPassing=e),t.passing?m.execute(i,a):f.once||m.remove.occurred(a),e!==n?t.passing:void 0},topVisible:function(e){var t=m.get.elementCalculations(),i=e||f.onTopVisible,a="topVisible";return e&&(m.debug("Adding callback for top visible",e),f.onTopVisible=e),t.topVisible?m.execute(i,a):f.once||m.remove.occurred(a),e===n?t.topVisible:void 0},bottomVisible:function(e){var t=m.get.elementCalculations(),i=e||f.onBottomVisible,a="bottomVisible";return e&&(m.debug("Adding callback for bottom visible",e),f.onBottomVisible=e),t.bottomVisible?m.execute(i,a):f.once||m.remove.occurred(a),e===n?t.bottomVisible:void 0},topPassed:function(e){var t=m.get.elementCalculations(),i=e||f.onTopPassed,a="topPassed";return e&&(m.debug("Adding callback for top passed",e),f.onTopPassed=e),t.topPassed?m.execute(i,a):f.once||m.remove.occurred(a),e===n?t.topPassed:void 0},bottomPassed:function(e){var t=m.get.elementCalculations(),i=e||f.onBottomPassed,a="bottomPassed";return e&&(m.debug("Adding callback for bottom passed",e),f.onBottomPassed=e),t.bottomPassed?m.execute(i,a):f.once||m.remove.occurred(a),e===n?t.bottomPassed:void 0},passingReverse:function(e){var t=m.get.elementCalculations(),i=e||f.onPassingReverse,a="passingReverse";return e&&(m.debug("Adding callback for passing reverse",e),f.onPassingReverse=e),t.passing?f.once||m.remove.occurred(a):m.get.occurred("passing")&&m.execute(i,a),e!==n?!t.passing:void 0},topVisibleReverse:function(e){var t=m.get.elementCalculations(),i=e||f.onTopVisibleReverse,a="topVisibleReverse";return e&&(m.debug("Adding callback for top visible reverse",e),f.onTopVisibleReverse=e),t.topVisible?f.once||m.remove.occurred(a):m.get.occurred("topVisible")&&m.execute(i,a),e===n?!t.topVisible:void 0},bottomVisibleReverse:function(e){var t=m.get.elementCalculations(),i=e||f.onBottomVisibleReverse,a="bottomVisibleReverse";return e&&(m.debug("Adding callback for bottom visible reverse",e),f.onBottomVisibleReverse=e),t.bottomVisible?f.once||m.remove.occurred(a):m.get.occurred("bottomVisible")&&m.execute(i,a),e===n?!t.bottomVisible:void 0},topPassedReverse:function(e){var t=m.get.elementCalculations(),i=e||f.onTopPassedReverse,a="topPassedReverse";return e&&(m.debug("Adding callback for top passed reverse",e),f.onTopPassedReverse=e),t.topPassed?f.once||m.remove.occurred(a):m.get.occurred("topPassed")&&m.execute(i,a),e===n?!t.onTopPassed:void 0},bottomPassedReverse:function(e){var t=m.get.elementCalculations(),i=e||f.onBottomPassedReverse,a="bottomPassedReverse";return e&&(m.debug("Adding callback for bottom passed reverse",e),f.onBottomPassedReverse=e),t.bottomPassed?f.once||m.remove.occurred(a):m.get.occurred("bottomPassed")&&m.execute(i,a),e===n?!t.bottomPassed:void 0},execute:function(e,t){var i=m.get.elementCalculations(),n=m.get.screenCalculations();e=e||!1,e&&(f.continuous?(m.debug("Callback being called continuously",t,i),e.call(S,i,n)):m.get.occurred(t)||(m.debug("Conditions met",t,i),e.call(S,i,n))),m.save.occurred(t)},remove:{fixed:function(){m.debug("Removing fixed position"),E.removeClass(g.fixed).css({position:"",top:"",left:"",zIndex:""})},occurred:function(e){if(e){var t=m.cache.occurred;t[e]!==n&&t[e]===!0&&(m.debug("Callback can now be called again",e),m.cache.occurred[e]=!1)}else m.cache.occurred={}}},save:{calculations:function(){m.verbose("Saving all calculations necessary to determine positioning"),m.save.direction(),m.save.screenCalculations(),m.save.elementCalculations()},occurred:function(e){e&&(m.cache.occurred[e]===n||m.cache.occurred[e]!==!0)&&(m.verbose("Saving callback occurred",e),m.cache.occurred[e]=!0)},scroll:function(e){e=e+f.offset||w.scrollTop()+f.offset,m.cache.scroll=e},direction:function(){var e,t=m.get.scroll(),i=m.get.lastScroll();return e=t>i&&i?"down":i>t&&i?"up":"static",m.cache.direction=e,m.cache.direction},elementPosition:function(){var e=m.cache.element,t=m.get.screenSize();return m.verbose("Saving element position"),e.fits=e.height<t.height,e.offset=E.offset(),e.width=E.outerWidth(),e.height=E.outerHeight(),m.cache.element=e,e},elementCalculations:function(){var e=m.get.screenCalculations(),t=m.get.elementPosition();return f.includeMargin?(t.margin={},t.margin.top=parseInt(E.css("margin-top"),10),t.margin.bottom=parseInt(E.css("margin-bottom"),10),t.top=t.offset.top-t.margin.top,t.bottom=t.offset.top+t.height+t.margin.bottom):(t.top=t.offset.top,t.bottom=t.offset.top+t.height),t.topVisible=e.bottom>=t.top,t.topPassed=e.top>=t.top,t.bottomVisible=e.bottom>=t.bottom,t.bottomPassed=e.top>=t.bottom,t.pixelsPassed=0,t.percentagePassed=0,t.onScreen=t.topVisible&&!t.bottomPassed,t.passing=t.topPassed&&!t.bottomPassed,t.offScreen=!t.onScreen,t.passing&&(t.pixelsPassed=e.top-t.top,t.percentagePassed=(e.top-t.top)/t.height),m.cache.element=t,m.verbose("Updated element calculations",t),t},screenCalculations:function(){var e=m.get.scroll();return m.save.direction(),m.cache.screen.top=e,m.cache.screen.bottom=e+m.cache.screen.height,m.cache.screen},screenSize:function(){m.verbose("Saving window position"),m.cache.screen={height:w.height()}},position:function(){m.save.screenSize(),m.save.elementPosition()}},get:{pixelsPassed:function(e){var t=m.get.elementCalculations();return e.search("%")>-1?t.height*(parseInt(e,10)/100):parseInt(e,10)},occurred:function(e){return m.cache.occurred!==n?m.cache.occurred[e]||!1:!1},direction:function(){return m.cache.direction===n&&m.save.direction(),m.cache.direction},elementPosition:function(){return m.cache.element===n&&m.save.elementPosition(),m.cache.element},elementCalculations:function(){return m.cache.element===n&&m.save.elementCalculations(),m.cache.element},screenCalculations:function(){return m.cache.screen===n&&m.save.screenCalculations(),m.cache.screen},screenSize:function(){return m.cache.screen===n&&m.save.screenSize(),m.cache.screen},scroll:function(){return m.cache.scroll===n&&m.save.scroll(),m.cache.scroll},lastScroll:function(){return m.cache.screen===n?(m.debug("First scroll event, no last scroll could be found"),!1):m.cache.screen.top}},setting:function(t,i){if(e.isPlainObject(t))e.extend(!0,f,t);else{if(i===n)return f[t];f[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,m,t);else{if(i===n)return m[t];m[t]=i}},debug:function(){f.debug&&(f.performance?m.performance.log(arguments):(m.debug=Function.prototype.bind.call(console.info,console,f.name+":"),m.debug.apply(console,arguments)))},verbose:function(){f.verbose&&f.debug&&(f.performance?m.performance.log(arguments):(m.verbose=Function.prototype.bind.call(console.info,console,f.name+":"),m.verbose.apply(console,arguments)))},error:function(){m.error=Function.prototype.bind.call(console.error,console,f.name+":"),m.error.apply(console,arguments)},performance:{log:function(e){var t,i,n;f.performance&&(t=(new Date).getTime(),n=l||t,i=t-n,l=t,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:S,"Execution Time":i})),clearTimeout(m.performance.timer),m.performance.timer=setTimeout(m.performance.display,500)},display:function(){var t=f.name+":",i=0;l=!1,clearTimeout(m.performance.timer),e.each(c,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",s&&(t+=" '"+s+"'"),(console.group!==n||console.table!==n)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,i,a){var r,s,l,c=D;return i=i||h,a=S||a,"string"==typeof t&&c!==n&&(t=t.split(/[\. ]/),r=t.length-1,e.each(t,function(i,a){var o=i!=r?a+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(e.isPlainObject(c[o])&&i!=r)c=c[o];else{if(c[o]!==n)return s=c[o],!1;if(!e.isPlainObject(c[a])||i==r)return c[a]!==n?(s=c[a],!1):(m.error(b.method,t),!1);c=c[a]}})),e.isFunction(s)?l=s.apply(a,i):s!==n&&(l=s),e.isArray(o)?o.push(l):o!==n?o=[o,l]:l!==n&&(o=l),s}},d?(D===n&&m.initialize(),D.save.scroll(),D.save.calculations(),m.invoke(u)):(D!==n&&D.invoke("destroy"),m.initialize())}),o!==n?o:this},e.fn.visibility.settings={name:"Visibility",namespace:"visibility",debug:!1,verbose:!1,performance:!0,observeChanges:!0,initialCheck:!0,refreshOnLoad:!0,refreshOnResize:!0,checkOnRefresh:!0,once:!0,continuous:!1,offset:0,includeMargin:!1,context:t,throttle:!1,type:!1,transition:"fade in",duration:1e3,onPassed:{},onOnScreen:!1,onOffScreen:!1,onPassing:!1,onTopVisible:!1,onBottomVisible:!1,onTopPassed:!1,onBottomPassed:!1,onPassingReverse:!1,onTopVisibleReverse:!1,onBottomVisibleReverse:!1,onTopPassedReverse:!1,onBottomPassedReverse:!1,onUpdate:!1,onRefresh:function(){},metadata:{src:"src"},className:{fixed:"fixed",placeholder:"placeholder"},error:{method:"The method you called is not defined.",visible:"Element is hidden, you must call refresh after element becomes visible"}}}(jQuery,window,document);